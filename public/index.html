<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mafia Stand-off ‚Äì Realtime</title>
  <meta name="description" content="Mafia Stand-off: Realtime karetn√≠ hra inspirovan√° noir mafi√°nsk√Ωm svƒõtem. Hrajte s p≈ô√°teli v re√°ln√©m ƒçase.">
  <style>
    /* =========================
       üé® T√âMATICK√â PROMƒöNN√â
    ========================= */
    :root {
      --bg: #0e1116;
      --panel: #0f141c;
      --panel-2:#0b1119;
      --glass: #0d1320cc;
      --muted: #93a4b8;
      --text: #ecf2f8;
      --accent: #5eead4;
      --accent-2: #7aa2ff;
      --warn: #ff7b7b;
      --ok: #7bffbd;
      --stroke: #2a3b52;
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --shadow-deep: 0 25px 70px rgba(0,0,0,.55);
      --radius: 20px;
      --transition-fast: 0.15s ease;
      --transition-slow: 0.35s ease;
    }

    /* =========================
       üñ•Ô∏è RESET A TYPOGRAFIE
    ========================= */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background:
        radial-gradient(1200px 800px at 10% -10%, #1a2230 0%, var(--bg) 60%) fixed,
        var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, sans-serif;
      line-height: 1.5;
      font-size: 15px;
    }
    a { color: var(--accent); text-decoration: none; transition: color var(--transition-fast); }
    a:hover { color: var(--accent-2); }

    /* =========================
       üì¶ LAYOUT
    ========================= */
    #app { max-width: 1200px; margin: 0 auto; padding: 16px 16px 24px; display: grid; gap: 14px; }
    .panel {
      background: linear-gradient(180deg, var(--panel), #0f141b);
      border: 1px solid rgba(255,255,255,.06);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
      transition: background var(--transition-slow), transform var(--transition-fast);
    }
    .panel:hover { transform: translateY(-1px); }

    /* =========================
       üîò BUTTONS
    ========================= */
    .btn {
      border: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, #1f2836, #151b25);
      color: var(--text);
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: var(--shadow);
      font-weight: 600;
      transition: all var(--transition-fast);
      user-select: none;
    }
    .btn:hover:not(:disabled) { transform: translateY(-1px); border-color: rgba(255,255,255,.18); }
    .btn:disabled { opacity: .6; cursor: not-allowed; transform: none; }
    .btn-primary { background: linear-gradient(180deg, #2a3344, #18202e); border-color: #3b4a63; }
    .btn-success { background: linear-gradient(180deg, #1f3a2e, #10261f); border-color: #1b6b53; }
    .btn-secondary { background: linear-gradient(180deg, #1f2836, #151b25); }
    .btn.pill { border-radius: 999px; padding: 12px 16px; font-weight: 800 }

    /* =========================
       üñãÔ∏è FORMUL√Å≈òE
    ========================= */
    .input {
      background: #0f141b;
      border: 1px solid var(--stroke);
      border-radius: 12px;
      padding: 10px 12px;
      color: var(--text);
      transition: border var(--transition-fast);
    }
    .input:focus { outline: none; border-color: var(--accent); }
    .input.big { padding: 14px; font-weight: 600; text-transform: uppercase; letter-spacing: .5px; }

    /* =========================
       üë• OSTATN√ç UI PRVKY
    ========================= */
    .row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
    .muted { color: var(--muted); }
    .title { font-weight: 800; letter-spacing: .3px; }
    .hint { color: #a7b9cf; font-size: 12px; }

    /* =========================
       üé¥ HERN√ç ST≈ÆL
    ========================= */
    .table { display: grid; grid-template-columns: repeat(3, 1fr); gap: 14px; }
    .opponent {
      background: linear-gradient(180deg, var(--panel), #10151c);
      border: 1px solid rgba(255,255,255,.06);
      border-radius: var(--radius);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      position: relative;
      box-shadow: var(--shadow);
      min-height: 132px;
      transition: border var(--transition-fast), transform var(--transition-fast);
    }
    .opponent:hover { border-color: var(--accent-2); transform: translateY(-2px); }
    .who { display: flex; align-items: center; justify-content: space-between; gap: 8px; font-weight: 700; }
    .role-pill {
      font-size: 12px;
      padding: 4px 8px;
      border-radius: 999px;
      background: #1f2937;
      color: #b7c5d8;
      border: 1px solid rgba(255,255,255,.06);
    }
    .role-pill.revealed { background: #253044; color: #cfe3ff; }
    .status { display: flex; gap: 6px; flex-wrap: wrap; }
    .badge {
      font-size: 12px; padding: 3px 8px;
      border-radius: 10px; border: 1px solid rgba(255,255,255,.08);
      color: #d3deea; background: #1e2633;
    }
    .hearts { display: flex; gap: 2px; }
    .heart {
  font-size: 18px;
  color: red; /* p≈ôid√°no */
  filter: drop-shadow(0 2px 6px rgba(0,0,0,.35));
}
    .cards { font-size: 13px; color: var(--muted); }

    /* =========================
       üÉè KARTY
    ========================= */
    .hand { display: flex; flex-wrap: wrap; gap: 10px; min-height: 90px; }
    .card {
      width: 140px; min-height: 86px;
      background: linear-gradient(120deg, #ffffff09 0%, #ffffff00 40%), linear-gradient(180deg, #19222e, #11161f);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 14px;
      padding: 8px;
      display: flex; flex-direction: column; gap: 6px;
      cursor: pointer; position: relative;
      box-shadow: var(--shadow);
      transition: transform var(--transition-fast), border var(--transition-fast);
    }
    .card:hover { transform: translateY(-2px); border-color: var(--accent-2); }
    .card.sel { outline: 2px solid var(--accent-2); }
    .card .ct { font-size: 12px; text-transform: uppercase; letter-spacing: .6px; color: #c6d7ee; }
    .card .emoji { font-size: 20px; }
    .card .text { font-size: 12px; color: #b8c5d7; }
    .target { outline: 2px dashed var(--accent-2); border-radius: 12px; }

    /* =========================
       üìú LOG A HUD
    ========================= */
    .log { padding: 12px; max-height: 260px; overflow-y: auto; font-size: 13px; background: #0a1018; border:1px solid #1c2940; border-radius:12px }
    .log div { margin-bottom: 2px; animation: fadeIn .3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(3px); } to { opacity: 1; transform: none; } }

    /* =========================
       ‚è≥ TIMER BAR
    ========================= */
    .timerWrap { margin: 8px 0; height: 8px; background: #192233; border-radius: 999px; overflow: hidden; border: 1px solid #2b3b54; }
    .timerBar { height: 100%; width: 100%; background: linear-gradient(90deg, #6ee7ff, #7aa2ff); transition: width .1s linear; }
    .timerBar.red { background: linear-gradient(90deg, #ff8a8a, #ff5b5b); }
    .timerBar.gold { background: linear-gradient(90deg, #ffe082, #ffc13d); }

    /* =========================
       üî≤ MOD√ÅLN√ç OVERLAYE
    ========================= */
    .overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,.55);
      display: none; align-items: center; justify-content: center;
      z-index: 40; padding: 20px;
    }
    .overlay.show { display: flex; animation: fadeIn .4s ease; }
    .ask-box {
      background: linear-gradient(180deg, #17202c, #0e141c);
      border: 1px solid #2a3b52;
      border-radius: 16px;
      padding: 16px;
      max-width: 520px; width: 100%;
      box-shadow: var(--shadow);
      text-align: center;
    }

    /* =========================
       üß≠ LOBBY VZHLED
    ========================= */
    .lobby-hero{ padding:0; overflow:hidden; border-radius:var(--radius); position:relative }
    .lobby-banner{ width:100%; padding-top:30%; position:relative; overflow:hidden; border-bottom:1px solid rgba(255,255,255,.06) }
    .lobby-banner img{ position:absolute; inset:0; width:100%; height:100%; object-fit:cover; filter:brightness(.99) contrast(1) }
    .lobby-wrap{ display:grid; grid-template-columns:1.1fr .9fr; gap:0 }
    .lobby-left{ padding:24px; display:flex; flex-direction:column; gap:14px }
    .lobby-right{ padding:22px; border-left:1px solid rgba(255,255,255,.06) }
    .lobby-title{ display:flex; gap:10px; align-items:center }
    .logo-img{ width:54px; height:54px; border-radius:12px; object-fit:contain; background:#0c1420; padding:4px; border:1px solid rgba(255,255,255,.08); box-shadow:0 4px 10px rgba(0,0,0,.5) }
    .glass{ background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01)), linear-gradient(180deg, var(--panel), var(--panel-2)); border:1px solid rgba(255,255,255,.12); border-radius:18px; padding:14px }
    .lobby-code{ display:inline-flex; align-items:center; gap:8px; font-weight:800; letter-spacing:1.4px; background:linear-gradient(180deg,#1b2331,#111824); padding:8px 12px; border-radius:999px; border:1px solid rgba(255,255,255,.12); }
    .players-card .list{ margin-top:6px; line-height:1.6; }
    .players-card .dot{ width:8px; height:8px; border-radius:50%; display:inline-block; margin-right:8px; background:#7aa2ff }
    .cta-row{ display:flex; gap:10px; flex-wrap:wrap; }

    /* =========================
       üì± RESPONSIVITA
    ========================= */
    @media (max-width:980px){
      .lobby-wrap{ grid-template-columns:1fr }
      .lobby-right{ border-left:none; border-top:1px solid rgba(255,255,255,.06) }
    }
    @media (max-width:930px) {
      .table { grid-template-columns: 1fr; }
      .center { grid-template-columns: 1fr; }
    }
    @media (max-width:520px) { .card { width: 100%; } }

    /* === Board layout === */
    .game-table {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 14px;
      margin-top: 14px;
    }
    .opponents-area {
      background: linear-gradient(180deg, #10151c, #0b1016);
      border-radius: var(--radius);
    }
    .player-area {
      background: linear-gradient(180deg, #141c28, #0e141c);
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .player-header {
      display: flex;
      gap: 14px;
      align-items: center;
      padding: 8px;
      border-bottom: 1px solid rgba(255,255,255,0.08);
    }
    .player-avatar {
      width: 64px;
      height: 64px;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,.12);
      background: #0b1016;
      box-shadow: var(--shadow);
    }
    .player-avatar img { width: 100%; height: 100%; object-fit: cover; }
    .player-info { flex: 1; display: flex; flex-direction: column; gap: 4px; }
    .player-name { font-weight: 800; font-size: 18px; }
    .player-hp { font-size: 18px; display: flex; gap: 2px; }
    .player-equip {
      display: flex; flex-direction: column; gap: 4px; padding: 8px;
      background: rgba(255,255,255,0.02); border-radius: 12px; margin: 0 8px;
    }
    .equip-slot { font-size: 14px; color: var(--muted); }
    .player-hand { padding: 8px; }
    .log-panel { margin-top: 14px; }

    @media(max-width: 800px){
      .game-table { grid-template-columns: 1fr; }
    }

    #diceResult {
  animation: diceRoll 1s ease infinite;
}

@keyframes diceRoll {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(20deg); }
  50% { transform: rotate(-20deg); }
  75% { transform: rotate(10deg); }
  100% { transform: rotate(0deg); }
}

  </style>

  <!-- D≈ÆLE≈ΩIT√â: defer zajist√≠, ≈æe DOM existuje d≈ô√≠v, ne≈æ game.js bƒõ≈æ√≠ -->
  <script src="game.js" defer></script>
</head>
<body>
  <div id="app" class="grid">

    <!-- LOBBY -->
    <section class="panel lobby-hero" id="lobbyPanel" aria-label="Lobby">
      <!-- HERO BANNER -->
      <div class="lobby-banner" aria-hidden="true">
        <img src="img/banner.jpg" alt="Mafia Stand-off Banner">
      </div>

      <div class="lobby-wrap">
        <!-- LEFT -->
        <div class="lobby-left">
          <div class="lobby-title">
            <img src="img/logo.png" alt="Mafia Stand-off Logo" class="logo-img">
            <div>
              <div class="brand">Mafia Stand-off</div>
              <div class="muted">Real-time party card game ‚Ä¢ a≈æ 7 hr√°ƒç≈Ø</div>
            </div>
          </div>

          <div class="glass">
            <div class="muted" style="margin-bottom:8px">Vytvo≈ôit novou hru</div>
            <div class="row">
              <input id="name" class="input big" placeholder="Va≈°e jm√©no" />
              <button id="createBtn" class="btn pill btn-primary">+ Vytvo≈ôit lobby</button>
            </div>
            <div class="hint" style="margin-top:8px">Tip: jm√©no m≈Ø≈æe≈° kdykoli zmƒõnit p≈ôed p≈ôipojen√≠m.</div>
          </div>

          <div class="glass players-card">
            <div class="muted" style="margin-bottom:6px">Hr√°ƒçi v lobby</div>
            <div id="players" class="list muted"><span class="hint">Zat√≠m nikdo‚Ä¶</span></div>
            <div class="cta-row" style="margin-top:10px">
              <button id="readyBtn" class="btn pill btn-secondary">Jsem p≈ôipraven</button>
              <button id="startBtn" class="btn pill btn-success" disabled>‚ñ∂ Start hry (host)</button>
            </div>
            <div id="lobbyInfo" class="hint" style="margin-top:8px"></div>
          </div>

          <div class="hint">Verze 0.1.2-alpha</div>
        </div>

        <!-- RIGHT -->
        <div class="lobby-right">
          <div class="glass">
            <div class="muted" style="margin-bottom:8px">P≈ôipojit se ke h≈ôe</div>
            <div class="row">
              <input id="joinId" class="input big" placeholder="K√≥d lobby (nap≈ô. ABCD)" style="width:100%;max-width:260px" />
              <button id="joinBtn" class="btn pill">P≈ôipojit</button>
            </div>
            <div style="margin-top:12px">
              <span class="lobby-code">K√ìD: <span id="codeMirror">‚Äî</span></span>
            </div>
            <div class="hint" style="margin-top:6px">K√≥d sd√≠l√≠ host pot√©, co lobby vytvo≈ô√≠.</div>
          </div>

          <div class="glass" style="margin-top:12px">
            <div class="muted">Jak to funguje?</div>
            <ul class="muted" style="margin:6px 0 0 18px; line-height:1.6">
              <li>Host klikne ‚ÄûVytvo≈ôit lobby‚Äú ‚Äì objev√≠ se k√≥d.</li>
              <li>Ostatn√≠ zadaj√≠ k√≥d a kliknou ‚ÄûP≈ôipojit‚Äú.</li>
              <li>Jakmile je v√°s min. 2 a v≈°ichni jsou ‚ÄûP≈ôipraveni‚Äú, host m≈Ø≈æe ‚ÄûStart hry‚Äú.</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- BOARD -->
    <section class="panel" id="boardPanel" style="display:none" aria-label="Hern√≠ st≈Øl">
      <div class="board-top row" style="justify-content:space-between;align-items:flex-start">
        <div>
          <b>üï¥Ô∏è Mafia Stand-off</b> <span class="muted" id="roomTag"></span>
          <div class="hud" id="hud"></div>
          <div class="hud" id="continental"></div>

          <!-- ‚úÖ Nov√Ω HUD ≈ô√°dek se spr√°vn√Ωmi ID -->
          <div class="row" style="margin-top:8px; gap:16px; font-size:14px">
            <div>üîÅ Na tahu: <b id="turnName">‚Äî</b></div>
            <div>üì¶ Bal√≠ƒçek: <b id="deckCount">0</b></div>
            <div>üóëÔ∏è Odhazovac√≠: <b id="discardCount">0</b></div>
          </div>

          <!-- Global event timer -->
          <div id="timerArea" style="display:none">
            <div class="hud" id="timerText"></div>
            <div class="timerWrap"><div id="timerBar" class="timerBar"></div></div>
          </div>
        </div>
        <div class="row">
          <button id="endTurn" class="btn">‚è≠Ô∏è Konec tahu</button>
          <button id="backLobby" class="btn">‚Üê Lobby</button>
        </div>
      </div>

      <!-- Hern√≠ st≈Øl -->
      <div class="game-table">
        <!-- Ostatn√≠ hr√°ƒçi -->
        <div class="opponents-area panel">
          <div class="title">Ostatn√≠ hr√°ƒçi</div>
          <div class="table" id="table"></div>
        </div>

        <!-- Moje postava -->
        <div class="player-area panel">
          <div class="player-header">
            <div class="player-avatar">
              <img src="img/player.png" alt="Moje postava">
            </div>
            <div class="player-info">
              <div class="player-name" id="myName">Moje postava</div>
              <div class="player-hp hearts" id="meHearts"></div>
              <div id="playerStatus" class="status"></div>
            </div>
          </div>
          <div class="player-equip">
            <div class="equip-slot">üî´ Zbra≈à: <span id="myWeapon">≈Ω√°dn√°</span></div>
            <div class="equip-slot">ü¶∫ Vesta: <span id="myVest">≈Ω√°dn√°</span></div>
          </div>
          <div class="player-hand">
            <div class="title">üíº Moje karty</div>
            <div id="hand" class="hand"></div>
          </div>
        </div>
      </div>

      <!-- Log -->
      <div class="panel log-panel">
        <div class="title">üìú Hern√≠ log</div>
        <div class="log" id="log" aria-live="polite"></div>
      </div>
    </section>

  </div>

  <!-- REACTION MODALS -->
  <!-- Shot (classic dodge) -->
  <div class="overlay" id="askShot" role="dialog" aria-modal="true" aria-labelledby="shotTitle">
    <div class="ask-box">
      <h3 id="shotTitle" style="margin:0 0 8px">Reakce na V√Ωst≈ôel</h3>
      <p class="muted" style="margin:0 0 10px">Zahr√°t üõ°Ô∏è √öhyb nebo p≈ôijmout z√°sah?</p>
      <div class="timerWrap" aria-hidden="true"><div id="shotTimer" class="timerBar red"></div></div>
      <div class="row" style="margin-top:8px">
        <button id="askShotYes" class="btn btn-primary">üõ°Ô∏è √öhyb</button>
        <button id="askShotNo" class="btn">Utr≈æit z√°sah</button>
      </div>
    </div>
  </div>

  <!-- Mass events (Shootout/Spray) -->
  <div class="overlay" id="askMass" role="dialog" aria-modal="true" aria-labelledby="massTitle" aria-describedby="massBody">
    <div class="ask-box">
      <h3 id="massTitle" style="margin:0 0 8px">Ud√°lost</h3>
      <p id="massBody" class="muted" style="margin:0 0 10px"></p>
      <div class="timerWrap" aria-hidden="true"><div id="massTimer" class="timerBar gold"></div></div>
      <div class="row" style="margin-top:8px">
        <button id="massYes" class="btn btn-primary">Odhodit po≈æadovanou kartu</button>
        <button id="massNo" class="btn">Nechat b√Ωt</button>
      </div>
    </div>
  </div>

  <!-- Vendetta -->
  <div class="overlay" id="askVend" role="dialog" aria-modal="true" aria-labelledby="vendTitle">
    <div class="ask-box">
      <h3 id="vendTitle" style="margin:0 0 8px">Vendeta ‚Äì tvoje odpovƒõƒè</h3>
      <p class="muted" style="margin:0 0 10px">Odhoƒè üî´ V√Ωst≈ôel, nebo p≈ôijmi z√°sah.</p>
      <div class="timerWrap" aria-hidden="true"><div id="vendTimer" class="timerBar red"></div></div>
      <div class="row" style="margin-top:8px">
        <button id="vendYes" class="btn btn-primary">Odhodit üî´</button>
        <button id="vendNo" class="btn">P≈ôijmout z√°sah</button>
      </div>
    </div>
  </div>

  <!-- Hod kostkou -->
  <div class="overlay" id="diceOverlay">
  <div class="ask-box" style="text-align:center">
    <h3>üé≤ Hod kostkou</h3>
    <div id="diceResult" style="font-size:50px; margin-top:10px;">üé≤</div>
  </div>
</div>

</body>
</html>
